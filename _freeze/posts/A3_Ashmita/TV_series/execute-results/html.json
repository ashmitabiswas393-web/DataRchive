{
  "hash": "25dc3506db7639696b9760fcc9687fed",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"TV series\"\nauthor: Ashmita\n---\n\n# TV Series Rating\n\n![](images/clipboard-3257828289.png)\n\n## About the Data\n\nThis data set is derived from the peasants of Manipal University to analyse the ratings of classic TV series - Friends, Modern Family, and Big Bang Theory\n\n## Data Dictionary\n\n**Qualitative Variables**\n\n:   **Name:** Name of the student\n\n:   **Gender:** Gender of the students categorized as 'Male' & 'Female'\n\n:   **Friends:** Rating of the 'Friends' TV show\n\n:   **Modern Family:** Rating of the 'Modern Family' TV show\n\n:   **Big Bang Theory:** Rating of the 'Big Bang Theory' TV show\n\n## Hypothesis\n\n-   Will Friends have significantly higher ratings than Big Bang Theory due to broader cultural popularity and peer influence?\n\n-   Is there a gender bias in the ratings where females might rate Friends higher and males rating Big Bang Theory higher due to its STEM themes?\n\n-   Modern Family might show the most balanced ratings across genders, reflecting its diverse character appeal.\n\n### Setup\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ purrr     1.1.0\n✔ forcats   1.0.0     ✔ stringr   1.5.2\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\nLoading required package: scales\n\n\nAttaching package: 'scales'\n\n\nThe following object is masked from 'package:purrr':\n\n    discard\n\n\nThe following object is masked from 'package:readr':\n\n    col_factor\n\n\nLoading required package: ggridges\n\n\nNew to ggformula?  Try the tutorials: \n\tlearnr::run_tutorial(\"introduction\", package = \"ggformula\")\n\tlearnr::run_tutorial(\"refining\", package = \"ggformula\")\n\nRegistered S3 method overwritten by 'mosaic':\n  method                           from   \n  fortify.SpatialPolygonsDataFrame ggplot2\n\n\nThe 'mosaic' package masks several functions from core packages in order to add \nadditional features.  The original behavior of these functions should not be affected by this.\n\n\nAttaching package: 'mosaic'\n\n\nThe following object is masked from 'package:Matrix':\n\n    mean\n\n\nThe following object is masked from 'package:scales':\n\n    rescale\n\n\nThe following objects are masked from 'package:dplyr':\n\n    count, do, tally\n\n\nThe following object is masked from 'package:purrr':\n\n    cross\n\n\nThe following object is masked from 'package:ggplot2':\n\n    stat\n\n\nThe following objects are masked from 'package:stats':\n\n    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,\n    quantile, sd, t.test, var\n\n\nThe following objects are masked from 'package:base':\n\n    max, mean, min, prod, range, sample, sum\n\n\n\nAttaching package: 'skimr'\n\n\nThe following object is masked from 'package:mosaic':\n\n    n_missing\n\n\n\nAttaching package: 'naniar'\n\n\nThe following object is masked from 'package:skimr':\n\n    n_complete\n\n\n\nAttaching package: 'janitor'\n\n\nThe following objects are masked from 'package:stats':\n\n    chisq.test, fisher.test\n\n\n\nAttaching package: 'tinytable'\n\n\nThe following object is masked from 'package:ggplot2':\n\n    theme_void\n\n\n\nAttaching package: 'crosstable'\n\n\nThe following object is masked from 'package:purrr':\n\n    compact\n\n\n\nAttaching package: 'supernova'\n\n\nThe following object is masked from 'package:scales':\n\n    number\n```\n\n\n:::\n:::\n\n\n### Inspecting the Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntv_series_data <- read_csv(\"~/Documents/R_work/DataRchive/posts/A3_Ashmita/Datasets/2-tv_series.csv\") %>%\njanitor::clean_names(case = \"snake\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 52 Columns: 5\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): Name, Gender\ndbl (3): Friends, Modern Family, Big Bang Theory\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\ntv_series_data\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 52 × 5\n   name    gender friends modern_family big_bang_theory\n   <chr>   <chr>    <dbl>         <dbl>           <dbl>\n 1 Diya    Female       8           9               9  \n 2 Ihina   Female       7           9               6  \n 3 Abhinav Male         8          10               7  \n 4 Nikhita Female       7           9               6  \n 5 Rishi   Male         8           6               5  \n 6 Charvi  Female       6           9               5.5\n 7 Maya    Female       8           7.5             9  \n 8 Anuva   Female       4           8               6  \n 9 Shourya Male         9           8               5  \n10 sarthak Male         7           9               3  \n# ℹ 42 more rows\n```\n\n\n:::\n:::\n\n\n### Checking for missing data\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntv_series_data %>%\n  visdat::vis_miss()\n```\n\n::: {.cell-output-display}\n![](TV_series_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntv_series_data %>%\n  visdat::vis_dat()\n```\n\n::: {.cell-output-display}\n![](TV_series_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n*Since there are a few missing numeric data, dropping the respective entries*\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntv_series_mod1 <- tv_series_data %>% \n  naniar::replace_with_na_all(condition = ~ .x %in% common_na_numbers) %>% \ndrop_na()\ntv_series_mod1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 46 × 5\n   name    gender friends modern_family big_bang_theory\n   <chr>   <chr>    <dbl>         <dbl>           <dbl>\n 1 Diya    Female       8           9               9  \n 2 Ihina   Female       7           9               6  \n 3 Abhinav Male         8          10               7  \n 4 Nikhita Female       7           9               6  \n 5 Rishi   Male         8           6               5  \n 6 Charvi  Female       6           9               5.5\n 7 Maya    Female       8           7.5             9  \n 8 Anuva   Female       4           8               6  \n 9 Shourya Male         9           8               5  \n10 sarthak Male         7           9               3  \n# ℹ 36 more rows\n```\n\n\n:::\n:::\n\n\nNumber of rows are reduced from 52 to 46, thereby 6 entries are removed\n\n### Munging the Data\n\nFactoring gender\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntv_series_mod2 <- tv_series_mod1 %>% \nmutate(gender = as.factor(gender))\n```\n:::\n\n\n## Examining the Data\n\n### Taking a glimpse of the Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(tv_series_mod2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 46\nColumns: 5\n$ name            <chr> \"Diya\", \"Ihina\", \"Abhinav\", \"Nikhita\", \"Rishi\", \"Charv…\n$ gender          <fct> Female, Female, Male, Female, Male, Female, Female, Fe…\n$ friends         <dbl> 8.0, 7.0, 8.0, 7.0, 8.0, 6.0, 8.0, 4.0, 9.0, 7.0, 8.0,…\n$ modern_family   <dbl> 9.0, 9.0, 10.0, 9.0, 6.0, 9.0, 7.5, 8.0, 8.0, 9.0, 8.0…\n$ big_bang_theory <dbl> 9.0, 6.0, 7.0, 6.0, 5.0, 5.5, 9.0, 6.0, 5.0, 3.0, 7.0,…\n```\n\n\n:::\n:::\n\n\n### Counting Gender\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntv_series_mod2 %>% \n  dplyr::count(gender) %>%\n  tt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script>\n\n      function styleCell_5q3newru27j2oikkrzdy(i, j, css_id) {\n          var table = document.getElementById(\"tinytable_5q3newru27j2oikkrzdy\");\n          var cell = table.querySelector(`[data-row=\"${i}\"][data-col=\"${j}\"]`);\n          if (cell) {\n              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);\n              cell.classList.add(css_id);\n          } else {\n              console.warn(`Cell at (${i}, ${j}) not found.`);\n          }\n      }\n      function spanCell_5q3newru27j2oikkrzdy(i, j, rowspan, colspan) {\n        var table = document.getElementById(\"tinytable_5q3newru27j2oikkrzdy\");\n        const targetCell = table.querySelector(`[data-row=\"${i}\"][data-col=\"${j}\"]`);\n        if (!targetCell) {\n          console.warn(`Cell at (${i}, ${j}) not found.`);\n        }\n\n        // Get all cells that need to be removed\n        const cellsToRemove = [];\n        for (let r = 0; r < rowspan; r++) {\n          for (let c = 0; c < colspan; c++) {\n            if (r === 0 && c === 0) continue; // Skip the target cell\n            const cell = table.querySelector(`[data-row=\"${i + r}\"][data-col=\"${j + c}\"]`);\n            if (cell) {\n              cellsToRemove.push(cell);\n            }\n          }\n        }\n\n        // Remove all cells\n        cellsToRemove.forEach(cell => cell.remove());\n\n        // Set rowspan and colspan of the target cell if it exists\n        if (targetCell) {\n          targetCell.rowSpan = rowspan;\n          targetCell.colSpan = colspan;\n        }\n      }\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '2', j: 0 }, { i: '2', j: 1 },  ], css_id: 'tinytable_css_x4t9ycbo4unfuu8ivmrc',}, \n          { positions: [ { i: '0', j: 0 }, { i: '0', j: 1 },  ], css_id: 'tinytable_css_elene1ob1tl2y4xod7lg',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  styleCell_5q3newru27j2oikkrzdy(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <style>\n      /* tinytable css entries after */\n      .table td.tinytable_css_x4t9ycbo4unfuu8ivmrc, .table th.tinytable_css_x4t9ycbo4unfuu8ivmrc { border-bottom: solid #d3d8dc 0.1em; }\n      .table td.tinytable_css_elene1ob1tl2y4xod7lg, .table th.tinytable_css_elene1ob1tl2y4xod7lg { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }\n    </style>\n    <div class=\"container\">\n      <table class=\"table table-borderless\" id=\"tinytable_5q3newru27j2oikkrzdy\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        <thead>\n        \n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"0\">gender</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">n</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"0\">Female</td>\n                  <td data-row=\"1\" data-col=\"1\">22</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"0\">Male</td>\n                  <td data-row=\"2\" data-col=\"1\">24</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n### Summarizing the Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(tv_series_mod2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     name              gender      friends       modern_family   \n Length:46          Female:22   Min.   : 1.000   Min.   : 3.000  \n Class :character   Male  :24   1st Qu.: 6.000   1st Qu.: 8.000  \n Mode  :character               Median : 7.000   Median : 9.000  \n                                Mean   : 6.891   Mean   : 8.304  \n                                3rd Qu.: 8.000   3rd Qu.: 9.000  \n                                Max.   :10.000   Max.   :10.000  \n big_bang_theory \n Min.   : 2.000  \n 1st Qu.: 5.000  \n Median : 7.000  \n Mean   : 6.446  \n 3rd Qu.: 8.000  \n Max.   :10.000  \n```\n\n\n:::\n:::\n\n\n### Observation\n\n-   There is nearly equal gender distribution where, female = 22 and male = 24\n\n-   We can see that the mean and median for the modern family is the highest, hence has the highest ratings\n\n-   Friends has wider spread ratings ranging from 1 to 10\n\n-   Big Bang Theory has more variability with wider quartiles\n\n## Restructuring the Data\n\n-   Since the data is now in a wide format, transforming it into a wide format and factoring the shows\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntv_series_mod3 <- tv_series_mod2 %>% \n  pivot_longer(\n    cols = c(friends, modern_family, big_bang_theory),\n    names_to = \"show\",\n    values_to = \"rating\"\n  ) %>%\n  mutate(show = as.factor(show))\n\n  glimpse(tv_series_mod3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 138\nColumns: 4\n$ name   <chr> \"Diya\", \"Diya\", \"Diya\", \"Ihina\", \"Ihina\", \"Ihina\", \"Abhinav\", \"…\n$ gender <fct> Female, Female, Female, Female, Female, Female, Male, Male, Mal…\n$ show   <fct> friends, modern_family, big_bang_theory, friends, modern_family…\n$ rating <dbl> 8.0, 9.0, 9.0, 7.0, 9.0, 6.0, 8.0, 10.0, 7.0, 7.0, 9.0, 6.0, 8.…\n```\n\n\n:::\n:::\n\n\n### Visualizing TV shows rating\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntv_series_mod3 %>% \n gf_dens(~rating, color = ~show, size = 1, fill = ~show) %>%\n  gf_labs(title = \"TV Series rating distributions\",\n          x = \"Ratings\",\n          y = \"Density\") %>% \n  gf_refine(\n    scale_x_continuous(breaks = seq(0, 10, 1))\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](TV_series_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntv_series_mod3 %>% \n    gf_boxplot(rating ~ show, fill = ~show, orientation = \"x\") %>%\n  gf_labs(title = \"Rating Distributions by Show and Gender\")\n```\n\n::: {.cell-output-display}\n![](TV_series_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n### TV shows rating vs. Gender\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntv_series_mod3 %>% \ngf_jitter(rating ~ show, color = ~gender, width = 0.075, alpha = 0.7) %>%\n  gf_labs(title = \"Individual Ratings by Gender\",\n          subtitle = \"Points = individual ratings, Boxes = distribution\")\n```\n\n::: {.cell-output-display}\n![](TV_series_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntv_series_mod3 %>% \n    gf_boxplot(rating ~ show, fill = ~gender, position = \"dodge\", orientation = \"x\") %>%\n  gf_labs(title = \"Rating Distributions by Show and Gender\")\n```\n\n::: {.cell-output-display}\n![](TV_series_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntv_series_mod2 %>%\n  select(friends, modern_family, big_bang_theory) %>%\n  ggpairs(\n    title = \"Do People Rate Shows Similarly?\",\n    lower = list(continuous = wrap(\"points\", alpha = 0.6, size = 2))\n  )\n```\n\n::: {.cell-output-display}\n![](TV_series_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntv_series_mod3 %>% \n  gf_histogram(~rating, fill = ~show, bins = 10) %>%\n  gf_facet_wrap(~ show) %>%\n  gf_labs(title = \"Rating Frequency Distributions\")\n```\n\n::: {.cell-output-display}\n![](TV_series_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntv_series_anova <- aov(rating ~ show, data = tv_series_mod3)\ntv_series_anova\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\n   aov(formula = rating ~ show, data = tv_series_mod3)\n\nTerms:\n                    show Residuals\nSum of Squares   86.6341  472.8098\nDeg. of Freedom        2       135\n\nResidual standard error: 1.871442\nEstimated effects may be unbalanced\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntv_series_supernova <-\n  supernova::pairwise(tv_series_anova,\n    correction = \"Bonferroni\",\n    alpha = 0.05, # 95% CI calculation\n    var_equal = TRUE,\n    plot = T\n  )\n```\n\n::: {.cell-output-display}\n![](TV_series_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntv_series_supernova$show\n```\n\n\n::: {.cell-output .cell-output-stderr}\n\n```\nshow\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLevels: 3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nFamily-wise error-rate: 0.049\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n  group_1       group_2          diff pooled_se     t    df  lower upper p_adj\n  <chr>         <chr>           <dbl>     <dbl> <dbl> <int>  <dbl> <dbl> <dbl>\n1 friends       big_bang_theory 0.446     0.276 1.615   135 -0.148 1.039 .3259\n2 modern_family big_bang_theory 1.859     0.276 6.736   135  1.265 2.452 .0000\n3 modern_family friends         1.413     0.276 5.121   135  0.820 2.006 .0000\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsupernova::supernova(tv_series_anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Analysis of Variance Table (Type III SS)\n Model: rating ~ show\n\n                              SS  df     MS      F   PRE     p\n ----- --------------- | ------- --- ------ ------ ----- -----\n Model (error reduced) |  86.634   2 43.317 12.368 .1549 .0000\n Error (from model)    | 472.810 135  3.502                   \n ----- --------------- | ------- --- ------ ------ ----- -----\n Total (empty model)   | 559.444 137  4.084                   \n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsupernova::equation(tv_series_anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nFitted equation:\nrating = 6.445652 + 0.4456522*showfriends + 1.858696*showmodern_family + e\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntv_series_mod3 %>%\n  mutate(fitted = fitted(tv_series_anova)) %>%\n  gf_jitter(rating ~ show,\n    width = 0.2, alpha = 0.6,\n    color = ~show,\n    data = .\n  ) %>%\n  gf_summary(\n    group = ~1,\n    fun = \"mean\", geom = \"line\", colour = \"lightblue\",\n    lty = 1, linewidth = 2\n  ) %>%\n  gf_point(fitted ~ show,\n    color = ~show,\n    shape = 2,\n    size = 6\n  ) %>%\n  gf_segment(fitted + fitted ~ 0 + show, linetype = 2, color = ~show) %>%\n \n  gf_labs(\n    title = \"Fitted ANOVA Model Equation\",\n    x = \"Ratings\", y = \"TV Series\"\n  ) %>%\n  gf_refine(\n    guides(colour = guide_legend(title = \"TV Series\"))\n  ) %>%\n  gf_refine(\n    scale_x_discrete(guide = \"prism_bracket\"),\n    scale_y_continuous(breaks = seq(0, 10, 1))\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: The S3 guide system was deprecated in ggplot2 3.5.0.\nℹ It has been replaced by a ggproto system that can be extended.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](TV_series_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(x = tv_series_mod3$rating)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  tv_series_mod3$rating\nW = 0.91645, p-value = 3.301e-07\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntv_series_anova$residuals %>%\n  as_tibble() %>%\n  gf_dhistogram(~value, data = .) %>%\n  gf_labs(\n    title = \"Residuals Histogram\",\n    x = \"Residuals\", y = \"Count\"\n  ) %>%\n  gf_fitdistr()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](TV_series_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n\n```{.r .cell-code}\n##\ntv_series_anova$residuals %>%\n  as_tibble() %>%\n  gf_qq(~value, data = .) %>%\n  gf_qqstep() %>%\n  gf_labs(\n    title = \"Residuals Q-Q Plot\",\n    x = \"Theoretical Quantiles\", y = \"Sample Quantiles\"\n  ) %>%\n  gf_qqline()\n```\n\n::: {.cell-output-display}\n![](TV_series_files/figure-html/unnamed-chunk-23-2.png){width=672}\n:::\n:::\n\n",
    "supporting": [
      "TV_series_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}